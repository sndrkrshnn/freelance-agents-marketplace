#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Frontend checks
echo "ğŸ“¦ Checking frontend..."
cd frontend
echo "  - Running linter..."
npm run lint -- --quiet || {
  echo "âŒ Frontend linting failed"
  exit 1
}

echo "  - Running type check..."
npm run type-check || {
  echo "âŒ Frontend type check failed"
  exit 1
}

echo "  - Running unit tests..."
npm run test:run || {
  echo "âŒ Frontend tests failed"
  exit 1
}

cd ..

# Backend checks
echo "ğŸ“¦ Checking backend..."
cd backend
echo "  - Running linter..."
npm run lint || {
  echo "âŒ Backend linting failed"
  exit 1
}

echo "  - Running unit tests..."
npm test -- --passWithNoTests || {
  echo "âŒ Backend tests failed"
  exit 1
}

cd ..

echo "âœ… All pre-commit checks passed!"
